"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ai-analyze-food";
exports.ids = ["pages/api/ai-analyze-food"];
exports.modules = {

/***/ "(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai-analyze-food&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cai-analyze-food.ts&middlewareConfigBase64=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai-analyze-food&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cai-analyze-food.ts&middlewareConfigBase64=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_ai_analyze_food_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src\\pages\\api\\ai-analyze-food.ts */ \"(api-node)/./src/pages/api/ai-analyze-food.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_ai_analyze_food_ts__WEBPACK_IMPORTED_MODULE_4__]);\n_src_pages_api_ai_analyze_food_ts__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_ai_analyze_food_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_ai_analyze_food_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/ai-analyze-food\",\n        pathname: \"/api/ai-analyze-food\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_ai_analyze_food_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    projectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/ai-analyze-food\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: undefined,\n                multiZoneDraftMode: Boolean(\"false\"),\n                trustHostHeader: undefined,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/ai-analyze-food\",\n                projectDir:  false || '',\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9uZXh0QDE1LjQuMV9yZWFjdC1kb21AMTkuMS4wX3JlYWN0QDE5LjEuMF9fcmVhY3RAMTkuMS4wL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYWktYW5hbHl6ZS1mb29kJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTVDcGFnZXMlNUNhcGklNUNhaS1hbmFseXplLWZvb2QudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXVEO0FBQ0M7QUFDdUM7QUFDckM7QUFDMUQ7QUFDa0U7QUFDTTtBQUNGO0FBQ3RFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyw4REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsOERBQVE7QUFDcEM7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCxnQkFBZ0IsTUFBdUM7QUFDdkQsQ0FBQztBQUNNO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUI7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUNBQW1DO0FBQy9DO0FBQ0E7QUFDQSx1QkFBdUIsNEVBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsNkNBQTZDLFNBQTZDO0FBQzFGLDRDQUE0QyxPQUF3QztBQUNwRixpQ0FBaUMsU0FBb0M7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLE1BQXVDO0FBQ25FO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsZ0ZBQWM7QUFDL0UsK0RBQStELHlDQUF5QztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxRQUFRLEVBQUUsTUFBTTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGtCQUFrQjtBQUNsQix1Q0FBdUMsUUFBUSxFQUFFLFFBQVE7QUFDekQ7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YsNkVBQTZFLGdGQUFjO0FBQzNGLGlDQUFpQyxRQUFRLEVBQUUsUUFBUTtBQUNuRCwwQkFBMEIsdUVBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxxRUFBUztBQUNqQixNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VuZEVycm9yIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBpLXV0aWxzXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3NyY1xcXFxwYWdlc1xcXFxhcGlcXFxcYWktYW5hbHl6ZS1mb29kLnRzXCI7XG5pbXBvcnQgeyBnZXRUcmFjZXIsIFNwYW5LaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL3RyYWNlclwiO1xuaW1wb3J0IHsgQmFzZVNlcnZlclNwYW4gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvY29uc3RhbnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FpLWFuYWx5emUtZm9vZFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FpLWFuYWx5emUtZm9vZFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kLFxuICAgIGRpc3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9ESVNUX0RJUiB8fCAnJyxcbiAgICBwcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJydcbn0pO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2FpLWFuYWx5emUtZm9vZFwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9XG4gICAgY29uc3QgcHJlcGFyZVJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLnByZXBhcmUocmVxLCByZXMsIHtcbiAgICAgICAgc3JjUGFnZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHsgcXVlcnksIHBhcmFtcywgcHJlcmVuZGVyTWFuaWZlc3QgfSA9IHByZXBhcmVSZXN1bHQ7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICAgICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XG4gICAgICAgIGNvbnN0IG9uUmVxdWVzdEVycm9yID0gcm91dGVNb2R1bGUuaW5zdHJ1bWVudGF0aW9uT25SZXF1ZXN0RXJyb3IuYmluZChyb3V0ZU1vZHVsZSk7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT5yb3V0ZU1vZHVsZS5yZW5kZXIocmVxLCByZXMsIHtcbiAgICAgICAgICAgICAgICBxdWVyeToge1xuICAgICAgICAgICAgICAgICAgICAuLi5xdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgLi4ucGFyYW1zXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBwYXJhbXMsXG4gICAgICAgICAgICAgICAgYWxsb3dlZFJldmFsaWRhdGVIZWFkZXJLZXlzOiBwcm9jZXNzLmVudi5fX05FWFRfQUxMT1dFRF9SRVZBTElEQVRFX0hFQURFUlMsXG4gICAgICAgICAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlOiBCb29sZWFuKHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREUpLFxuICAgICAgICAgICAgICAgIHRydXN0SG9zdEhlYWRlcjogcHJvY2Vzcy5lbnYuX19ORVhUX1RSVVNUX0hPU1RfSEVBREVSLFxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGdldCB0aGlzIGZyb20gZnJvbSBydW50aW1lIGVudiBzbyBtYW5pZmVzdFxuICAgICAgICAgICAgICAgIC8vIGRvZXNuJ3QgbmVlZCB0byBsb2FkXG4gICAgICAgICAgICAgICAgcHJldmlld1Byb3BzOiBwcmVyZW5kZXJNYW5pZmVzdC5wcmV2aWV3LFxuICAgICAgICAgICAgICAgIHByb3BhZ2F0ZUVycm9yOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBkZXY6IHJvdXRlTW9kdWxlLmlzRGV2LFxuICAgICAgICAgICAgICAgIHBhZ2U6IFwiL2FwaS9haS1hbmFseXplLWZvb2RcIixcbiAgICAgICAgICAgICAgICBwcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJycsXG4gICAgICAgICAgICAgICAgb25FcnJvcjogKC4uLmFyZ3MpPT5vblJlcXVlc3RFcnJvcihyZXEsIC4uLmFyZ3MpXG4gICAgICAgICAgICB9KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShhY3RpdmVTcGFuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRyYWNlci53aXRoUHJvcGFnYXRlZENvbnRleHQocmVxLmhlYWRlcnMsICgpPT50cmFjZXIudHJhY2UoQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCwge1xuICAgICAgICAgICAgICAgICAgICBzcGFuTmFtZTogYCR7bWV0aG9kfSAke3JlcS51cmx9YCxcbiAgICAgICAgICAgICAgICAgICAga2luZDogU3BhbktpbmQuU0VSVkVSLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5tZXRob2QnOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC50YXJnZXQnOiByZXEudXJsXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBpbnZva2VSb3V0ZU1vZHVsZSkpO1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIHdlIHJlLXRocm93IGluIGRldiB0byBzaG93IHRoZSBlcnJvciBvdmVybGF5XG4gICAgICAgIGlmIChyb3V0ZU1vZHVsZS5pc0Rldikge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgICAgIC8vIHRoaXMgaXMgdGVjaG5pY2FsbHkgYW4gaW52YXJpYW50IGFzIGVycm9yIGhhbmRsaW5nXG4gICAgICAgIC8vIHNob3VsZCBiZSBkb25lIGluc2lkZSBvZiBhcGktcmVzb2x2ZXIgb25FcnJvclxuICAgICAgICBzZW5kRXJyb3IocmVzLCA1MDAsICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InKTtcbiAgICB9IGZpbmFsbHl7XG4gICAgICAgIC8vIFdlIGRvbid0IGFsbG93IGFueSB3YWl0VW50aWwgd29yayBpbiBwYWdlcyBBUEkgcm91dGVzIGN1cnJlbnRseVxuICAgICAgICAvLyBzbyBpZiBjYWxsYmFjayBpcyBwcmVzZW50IHJldHVybiB3aXRoIHJlc29sdmVkIHByb21pc2Ugc2luY2Ugbm9cbiAgICAgICAgLy8gcGVuZGluZyB3b3JrXG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai-analyze-food&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cai-analyze-food.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/ai-analyze-food.ts":
/*!******************************************!*\
  !*** ./src/pages/api/ai-analyze-food.ts ***!
  \******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _services_grokClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../services/grokClient */ \"(api-node)/./src/services/grokClient.ts\");\n/* harmony import */ var _services_modalClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../services/modalClient */ \"(api-node)/./src/services/modalClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_services_grokClient__WEBPACK_IMPORTED_MODULE_0__, _services_modalClient__WEBPACK_IMPORTED_MODULE_1__]);\n([_services_grokClient__WEBPACK_IMPORTED_MODULE_0__, _services_modalClient__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n// Enable the body parser for JSON and increase the payload size\nconst config = {\n    api: {\n        bodyParser: {\n            sizeLimit: '10mb'\n        }\n    }\n};\n/**\n * Advanced AI food image analyzer using Grok and Modal APIs\n * Provides food detection and detailed nutritional analysis\n */ async function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            error: 'Method not allowed'\n        });\n    }\n    try {\n        console.log('Received image analysis request');\n        const { image } = req.body;\n        if (!image) {\n            return res.status(400).json({\n                error: 'No image data provided'\n            });\n        }\n        console.log('Image data received, length:', image.length);\n        // Check if image is a base64 string\n        if (!image.startsWith('data:image')) {\n            return res.status(400).json({\n                error: 'Invalid image format. Image must be a base64 data URL'\n            });\n        }\n        // Check for required environment variables\n        if (!process.env.GROK_API_KEY) {\n            console.error('GROK_API_KEY environment variable is not set');\n            return res.status(500).json({\n                error: 'API configuration is incomplete: GROK_API_KEY missing'\n            });\n        }\n        if (!process.env.MODAL_API_KEY) {\n            console.error('MODAL_API_KEY environment variable is not set');\n            return res.status(500).json({\n                error: 'API configuration is incomplete: MODAL_API_KEY missing'\n            });\n        }\n        // Step 1: Analyze image with Grok to identify food items\n        console.log('Calling Grok API for vision analysis');\n        let grokResponse;\n        try {\n            grokResponse = await (0,_services_grokClient__WEBPACK_IMPORTED_MODULE_0__.analyzeImageWithGrok)(image);\n            console.log('Grok analysis complete, identified food items:', grokResponse.foodItems.length);\n        } catch (grokError) {\n            console.error('Grok analysis failed:', grokError);\n            return res.status(500).json({\n                error: `Grok analysis failed: ${grokError.message || String(grokError)}`\n            });\n        }\n        if (!grokResponse.foodItems || grokResponse.foodItems.length === 0) {\n            return res.status(400).json({\n                error: 'No food items detected in the image'\n            });\n        }\n        // Step 2: Get nutritional analysis with Modal backend\n        console.log('Calling Modal backend for nutritional analysis');\n        let nutritionalData;\n        try {\n            nutritionalData = await (0,_services_modalClient__WEBPACK_IMPORTED_MODULE_1__.analyzeImageWithModal)(image, grokResponse);\n            console.log('Modal analysis complete');\n        } catch (modalError) {\n            console.error('Modal analysis failed:', modalError);\n            // Continue with partial results even if Modal analysis fails\n            nutritionalData = {\n                nutritionalEstimate: {\n                    calories: 0,\n                    protein: 0,\n                    carbs: 0,\n                    fat: 0\n                },\n                healthInsights: [],\n                warnings: [\n                    \"Nutritional analysis failed: \" + (modalError.message || String(modalError))\n                ]\n            };\n            console.log('Continuing with partial results after Modal API failure');\n        }\n        // Step 3: Return combined results\n        const response = {\n            success: true,\n            foodItems: grokResponse.foodItems,\n            description: grokResponse.description,\n            nutritionalData,\n            detailedAnalysis: grokResponse.detailedAnalysis\n        };\n        console.log('Analysis complete, returning results');\n        return res.status(200).json(response);\n    } catch (error) {\n        console.error('Error in AI analysis:', error);\n        return res.status(500).json({\n            error: `API error: ${error.message || String(error)}`\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvYWktYW5hbHl6ZS1mb29kLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFDaUU7QUFDRTtBQU1uRSxnRUFBZ0U7QUFDekQsTUFBTUUsU0FBUztJQUNwQkMsS0FBSztRQUNIQyxZQUFZO1lBQ1ZDLFdBQVc7UUFDYjtJQUNGO0FBQ0YsRUFBRTtBQUVGOzs7Q0FHQyxHQUNjLGVBQWVDLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEIsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVE7UUFDekIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXFCO0lBQzVEO0lBRUEsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNLEVBQUVDLEtBQUssRUFBRSxHQUFHUixJQUFJUyxJQUFJO1FBRTFCLElBQUksQ0FBQ0QsT0FBTztZQUNWLE9BQU9QLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBeUI7UUFDaEU7UUFFQUMsUUFBUUMsR0FBRyxDQUFDLGdDQUFnQ0MsTUFBTUUsTUFBTTtRQUN4RCxvQ0FBb0M7UUFDcEMsSUFBSSxDQUFDRixNQUFNRyxVQUFVLENBQUMsZUFBZTtZQUNuQyxPQUFPVixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQXdEO1FBQy9GO1FBRUEsMkNBQTJDO1FBQzNDLElBQUksQ0FBQ08sUUFBUUMsR0FBRyxDQUFDQyxZQUFZLEVBQUU7WUFDN0JSLFFBQVFELEtBQUssQ0FBQztZQUNkLE9BQU9KLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBd0Q7UUFDL0Y7UUFFQSxJQUFJLENBQUNPLFFBQVFDLEdBQUcsQ0FBQ0UsYUFBYSxFQUFFO1lBQzlCVCxRQUFRRCxLQUFLLENBQUM7WUFDZCxPQUFPSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQXlEO1FBQ2hHO1FBRUEseURBQXlEO1FBQ3pEQyxRQUFRQyxHQUFHLENBQUM7UUFDWixJQUFJUztRQUNKLElBQUk7WUFDRkEsZUFBZSxNQUFNdkIsMEVBQW9CQSxDQUFDZTtZQUMxQ0YsUUFBUUMsR0FBRyxDQUFDLGtEQUFrRFMsYUFBYUMsU0FBUyxDQUFDUCxNQUFNO1FBQzdGLEVBQUUsT0FBT1EsV0FBZ0I7WUFDdkJaLFFBQVFELEtBQUssQ0FBQyx5QkFBeUJhO1lBQ3ZDLE9BQU9qQixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPLENBQUMsc0JBQXNCLEVBQUVhLFVBQVVDLE9BQU8sSUFBSUMsT0FBT0YsWUFBWTtZQUFDO1FBQ3pHO1FBRUEsSUFBSSxDQUFDRixhQUFhQyxTQUFTLElBQUlELGFBQWFDLFNBQVMsQ0FBQ1AsTUFBTSxLQUFLLEdBQUc7WUFDbEUsT0FBT1QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFzQztRQUM3RTtRQUVBLHNEQUFzRDtRQUN0REMsUUFBUUMsR0FBRyxDQUFDO1FBQ1osSUFBSWM7UUFDSixJQUFJO1lBQ0ZBLGtCQUFrQixNQUFNM0IsNEVBQXFCQSxDQUFDYyxPQUFPUTtZQUNyRFYsUUFBUUMsR0FBRyxDQUFDO1FBQ2QsRUFBRSxPQUFPZSxZQUFpQjtZQUN4QmhCLFFBQVFELEtBQUssQ0FBQywwQkFBMEJpQjtZQUN4Qyw2REFBNkQ7WUFDN0RELGtCQUFrQjtnQkFDaEJFLHFCQUFxQjtvQkFDbkJDLFVBQVU7b0JBQ1ZDLFNBQVM7b0JBQ1RDLE9BQU87b0JBQ1BDLEtBQUs7Z0JBQ1A7Z0JBQ0FDLGdCQUFnQixFQUFFO2dCQUNsQkMsVUFBVTtvQkFBQyxrQ0FBbUNQLENBQUFBLFdBQVdILE9BQU8sSUFBSUMsT0FBT0UsV0FBVTtpQkFBRztZQUMxRjtZQUNBaEIsUUFBUUMsR0FBRyxDQUFDO1FBQ2Q7UUFFQSxrQ0FBa0M7UUFDbEMsTUFBTXVCLFdBQVc7WUFDZkMsU0FBUztZQUNUZCxXQUFXRCxhQUFhQyxTQUFTO1lBQ2pDZSxhQUFhaEIsYUFBYWdCLFdBQVc7WUFDckNYO1lBQ0FZLGtCQUFrQmpCLGFBQWFpQixnQkFBZ0I7UUFDakQ7UUFFQTNCLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9OLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUMwQjtJQUU5QixFQUFFLE9BQU96QixPQUFZO1FBQ25CQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxPQUFPSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU8sQ0FBQyxXQUFXLEVBQUVBLE1BQU1jLE9BQU8sSUFBSUMsT0FBT2YsUUFBUTtRQUFDO0lBQ3RGO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxQcm9qZWN0c1xcSGFja2F0aG9uIEp1bHkgMjAyNVxcVml0YWxtYXRyaXhcXHNyY1xccGFnZXNcXGFwaVxcYWktYW5hbHl6ZS1mb29kLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgYW5hbHl6ZUltYWdlV2l0aEdyb2sgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9ncm9rQ2xpZW50JztcbmltcG9ydCB7IGFuYWx5emVJbWFnZVdpdGhNb2RhbCB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21vZGFsQ2xpZW50JztcblxuaW50ZXJmYWNlIEZvb2RBbmFseXNpc1JlcXVlc3Qge1xuICBpbWFnZTogc3RyaW5nO1xufVxuXG4vLyBFbmFibGUgdGhlIGJvZHkgcGFyc2VyIGZvciBKU09OIGFuZCBpbmNyZWFzZSB0aGUgcGF5bG9hZCBzaXplXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBhcGk6IHtcbiAgICBib2R5UGFyc2VyOiB7XG4gICAgICBzaXplTGltaXQ6ICcxMG1iJyxcbiAgICB9LFxuICB9LFxufTtcblxuLyoqXG4gKiBBZHZhbmNlZCBBSSBmb29kIGltYWdlIGFuYWx5emVyIHVzaW5nIEdyb2sgYW5kIE1vZGFsIEFQSXNcbiAqIFByb3ZpZGVzIGZvb2QgZGV0ZWN0aW9uIGFuZCBkZXRhaWxlZCBudXRyaXRpb25hbCBhbmFseXNpc1xuICovXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZVxuKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBpbWFnZSBhbmFseXNpcyByZXF1ZXN0Jyk7XG4gICAgY29uc3QgeyBpbWFnZSB9ID0gcmVxLmJvZHkgYXMgRm9vZEFuYWx5c2lzUmVxdWVzdDtcblxuICAgIGlmICghaW1hZ2UpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnTm8gaW1hZ2UgZGF0YSBwcm92aWRlZCcgfSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdJbWFnZSBkYXRhIHJlY2VpdmVkLCBsZW5ndGg6JywgaW1hZ2UubGVuZ3RoKTtcbiAgICAvLyBDaGVjayBpZiBpbWFnZSBpcyBhIGJhc2U2NCBzdHJpbmdcbiAgICBpZiAoIWltYWdlLnN0YXJ0c1dpdGgoJ2RhdGE6aW1hZ2UnKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIGltYWdlIGZvcm1hdC4gSW1hZ2UgbXVzdCBiZSBhIGJhc2U2NCBkYXRhIFVSTCcgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgIGlmICghcHJvY2Vzcy5lbnYuR1JPS19BUElfS0VZKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdHUk9LX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldCcpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBUEkgY29uZmlndXJhdGlvbiBpcyBpbmNvbXBsZXRlOiBHUk9LX0FQSV9LRVkgbWlzc2luZycgfSk7XG4gICAgfVxuICAgIFxuICAgIGlmICghcHJvY2Vzcy5lbnYuTU9EQUxfQVBJX0tFWSkge1xuICAgICAgY29uc29sZS5lcnJvcignTU9EQUxfQVBJX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyBub3Qgc2V0Jyk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FQSSBjb25maWd1cmF0aW9uIGlzIGluY29tcGxldGU6IE1PREFMX0FQSV9LRVkgbWlzc2luZycgfSk7XG4gICAgfVxuXG4gICAgLy8gU3RlcCAxOiBBbmFseXplIGltYWdlIHdpdGggR3JvayB0byBpZGVudGlmeSBmb29kIGl0ZW1zXG4gICAgY29uc29sZS5sb2coJ0NhbGxpbmcgR3JvayBBUEkgZm9yIHZpc2lvbiBhbmFseXNpcycpO1xuICAgIGxldCBncm9rUmVzcG9uc2U7XG4gICAgdHJ5IHtcbiAgICAgIGdyb2tSZXNwb25zZSA9IGF3YWl0IGFuYWx5emVJbWFnZVdpdGhHcm9rKGltYWdlKTtcbiAgICAgIGNvbnNvbGUubG9nKCdHcm9rIGFuYWx5c2lzIGNvbXBsZXRlLCBpZGVudGlmaWVkIGZvb2QgaXRlbXM6JywgZ3Jva1Jlc3BvbnNlLmZvb2RJdGVtcy5sZW5ndGgpO1xuICAgIH0gY2F0Y2ggKGdyb2tFcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdHcm9rIGFuYWx5c2lzIGZhaWxlZDonLCBncm9rRXJyb3IpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGBHcm9rIGFuYWx5c2lzIGZhaWxlZDogJHtncm9rRXJyb3IubWVzc2FnZSB8fCBTdHJpbmcoZ3Jva0Vycm9yKX1gIH0pO1xuICAgIH1cblxuICAgIGlmICghZ3Jva1Jlc3BvbnNlLmZvb2RJdGVtcyB8fCBncm9rUmVzcG9uc2UuZm9vZEl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdObyBmb29kIGl0ZW1zIGRldGVjdGVkIGluIHRoZSBpbWFnZScgfSk7XG4gICAgfVxuXG4gICAgLy8gU3RlcCAyOiBHZXQgbnV0cml0aW9uYWwgYW5hbHlzaXMgd2l0aCBNb2RhbCBiYWNrZW5kXG4gICAgY29uc29sZS5sb2coJ0NhbGxpbmcgTW9kYWwgYmFja2VuZCBmb3IgbnV0cml0aW9uYWwgYW5hbHlzaXMnKTtcbiAgICBsZXQgbnV0cml0aW9uYWxEYXRhO1xuICAgIHRyeSB7XG4gICAgICBudXRyaXRpb25hbERhdGEgPSBhd2FpdCBhbmFseXplSW1hZ2VXaXRoTW9kYWwoaW1hZ2UsIGdyb2tSZXNwb25zZSk7XG4gICAgICBjb25zb2xlLmxvZygnTW9kYWwgYW5hbHlzaXMgY29tcGxldGUnKTtcbiAgICB9IGNhdGNoIChtb2RhbEVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ01vZGFsIGFuYWx5c2lzIGZhaWxlZDonLCBtb2RhbEVycm9yKTtcbiAgICAgIC8vIENvbnRpbnVlIHdpdGggcGFydGlhbCByZXN1bHRzIGV2ZW4gaWYgTW9kYWwgYW5hbHlzaXMgZmFpbHNcbiAgICAgIG51dHJpdGlvbmFsRGF0YSA9IHtcbiAgICAgICAgbnV0cml0aW9uYWxFc3RpbWF0ZToge1xuICAgICAgICAgIGNhbG9yaWVzOiAwLFxuICAgICAgICAgIHByb3RlaW46IDAsXG4gICAgICAgICAgY2FyYnM6IDAsXG4gICAgICAgICAgZmF0OiAwLFxuICAgICAgICB9LFxuICAgICAgICBoZWFsdGhJbnNpZ2h0czogW10sXG4gICAgICAgIHdhcm5pbmdzOiBbXCJOdXRyaXRpb25hbCBhbmFseXNpcyBmYWlsZWQ6IFwiICsgKG1vZGFsRXJyb3IubWVzc2FnZSB8fCBTdHJpbmcobW9kYWxFcnJvcikpXVxuICAgICAgfTtcbiAgICAgIGNvbnNvbGUubG9nKCdDb250aW51aW5nIHdpdGggcGFydGlhbCByZXN1bHRzIGFmdGVyIE1vZGFsIEFQSSBmYWlsdXJlJyk7XG4gICAgfVxuXG4gICAgLy8gU3RlcCAzOiBSZXR1cm4gY29tYmluZWQgcmVzdWx0c1xuICAgIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGZvb2RJdGVtczogZ3Jva1Jlc3BvbnNlLmZvb2RJdGVtcyxcbiAgICAgIGRlc2NyaXB0aW9uOiBncm9rUmVzcG9uc2UuZGVzY3JpcHRpb24sXG4gICAgICBudXRyaXRpb25hbERhdGEsXG4gICAgICBkZXRhaWxlZEFuYWx5c2lzOiBncm9rUmVzcG9uc2UuZGV0YWlsZWRBbmFseXNpc1xuICAgIH07XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0FuYWx5c2lzIGNvbXBsZXRlLCByZXR1cm5pbmcgcmVzdWx0cycpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihyZXNwb25zZSk7XG5cbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIEFJIGFuYWx5c2lzOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogYEFQSSBlcnJvcjogJHtlcnJvci5tZXNzYWdlIHx8IFN0cmluZyhlcnJvcil9YCB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImFuYWx5emVJbWFnZVdpdGhHcm9rIiwiYW5hbHl6ZUltYWdlV2l0aE1vZGFsIiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsInNpemVMaW1pdCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiaW1hZ2UiLCJib2R5IiwibGVuZ3RoIiwic3RhcnRzV2l0aCIsInByb2Nlc3MiLCJlbnYiLCJHUk9LX0FQSV9LRVkiLCJNT0RBTF9BUElfS0VZIiwiZ3Jva1Jlc3BvbnNlIiwiZm9vZEl0ZW1zIiwiZ3Jva0Vycm9yIiwibWVzc2FnZSIsIlN0cmluZyIsIm51dHJpdGlvbmFsRGF0YSIsIm1vZGFsRXJyb3IiLCJudXRyaXRpb25hbEVzdGltYXRlIiwiY2Fsb3JpZXMiLCJwcm90ZWluIiwiY2FyYnMiLCJmYXQiLCJoZWFsdGhJbnNpZ2h0cyIsIndhcm5pbmdzIiwicmVzcG9uc2UiLCJzdWNjZXNzIiwiZGVzY3JpcHRpb24iLCJkZXRhaWxlZEFuYWx5c2lzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/ai-analyze-food.ts\n");

/***/ }),

/***/ "(api-node)/./src/services/grokClient.ts":
/*!************************************!*\
  !*** ./src/services/grokClient.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   analyzeImageWithGrok: () => (/* binding */ analyzeImageWithGrok)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! https */ \"https\");\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(https__WEBPACK_IMPORTED_MODULE_1__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n/**\n * Analyze an image using the Grok Vision API\n * @param imageDataUrl - Base64 encoded image data URL (data:image/jpeg;base64,xxxxx)\n */ async function analyzeImageWithGrok(imageDataUrl) {\n    try {\n        console.log('Sending image to Grok Vision API for analysis');\n        // This is a server-side function that will be called from the API route\n        // Not from the client browser - this avoids CORS and SSL issues\n        // For security, we'll get the API key from environment variables\n        const GROK_API_KEY = process.env.GROK_API_KEY;\n        if (!GROK_API_KEY) {\n            throw new Error('GROK_API_KEY environment variable is not set');\n        }\n        // Use the correct API endpoint from the xAI documentation\n        const GROK_API_ENDPOINT = process.env.GROK_API_ENDPOINT || 'https://api.x.ai/v1/chat/completions';\n        // Use the appropriate model version\n        const GROK_MODEL = process.env.GROK_MODEL || 'grok-2-vision-1212'; // Vision-capable model\n        console.log('Using API endpoint:', GROK_API_ENDPOINT);\n        console.log('Using model:', GROK_MODEL);\n        // Validate that we have a proper data URL\n        if (!imageDataUrl.startsWith('data:image')) {\n            throw new Error('Invalid image format. Expected data URL format.');\n        }\n        // Format request according to the xAI API specification\n        const response = await (0,axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            method: 'post',\n            url: GROK_API_ENDPOINT,\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${GROK_API_KEY}`\n            },\n            timeout: 30000,\n            // Configure axios with proper SSL handling\n            httpsAgent:  true && process.env.ALLOW_INSECURE_SSL === 'true' ? new (https__WEBPACK_IMPORTED_MODULE_1___default().Agent)({\n                rejectUnauthorized: false\n            }) // Only in development with explicit permission\n             : undefined,\n            data: {\n                model: GROK_MODEL,\n                messages: [\n                    {\n                        role: \"user\",\n                        content: [\n                            {\n                                type: \"text\",\n                                text: `Analyze this food image and provide a detailed nutritional analysis. Return your response as a JSON object with the following structure:\n\n{\n  \"foods\": [\n    {\n      \"name\": \"Food item name\",\n      \"portion\": \"Estimated portion size\",\n      \"calories\": \"Estimated calories per serving\",\n      \"macros\": {\n        \"protein\": \"X grams\",\n        \"carbs\": \"X grams\",\n        \"fat\": \"X grams\",\n        \"fiber\": \"X grams\"\n      },\n      \"vitamins\": [\"Key vitamins present\"],\n      \"minerals\": [\"Key minerals present\"]\n    }\n  ],\n  \"totalNutrition\": {\n    \"calories\": \"Total estimated calories\",\n    \"protein\": \"Total protein\",\n    \"carbs\": \"Total carbohydrates\",\n    \"fat\": \"Total fat\"\n  },\n  \"healthScore\": \"1-10 rating\",\n  \"benefits\": [\"Health benefits\"],\n  \"concerns\": [\"Health concerns if any\"],\n  \"dietaryTags\": [\"vegetarian\", \"vegan\", \"gluten-free\", \"dairy-free\", \"keto-friendly\", \"high-protein\", \"low-carb\", etc.]\n}\n\nProvide accurate nutritional estimates based on visible portions and typical serving sizes.`\n                            },\n                            {\n                                type: \"image_url\",\n                                image_url: {\n                                    url: imageDataUrl,\n                                    detail: \"high\" // Use high detail for better nutritional analysis\n                                }\n                            }\n                        ]\n                    }\n                ],\n                temperature: 0.7,\n                max_tokens: 1024\n            }\n        });\n        if (!response.data) {\n            throw new Error('Received empty response from Grok API');\n        }\n        console.log('Received response from Grok API');\n        console.log('Response usage:', response.data.usage); // Log token usage for monitoring\n        // Process the AI response into our expected format\n        if (!response.data.choices || !response.data.choices[0]?.message?.content) {\n            console.error('Invalid response structure:', response.data);\n            throw new Error('Unexpected response format from Grok API: missing choices or content');\n        }\n        const aiContent = response.data.choices[0].message.content;\n        console.log('AI Content received, length:', aiContent.length);\n        // Extract food items and other details\n        const foodItems = [];\n        // Try to parse the response based on formatting\n        try {\n            // First check if there are JSON blocks in the response\n            const jsonMatch = aiContent.match(/```json([\\s\\S]*?)```/);\n            if (jsonMatch && jsonMatch[1]) {\n                // Parse any JSON data in the response\n                const jsonData = JSON.parse(jsonMatch[1].trim());\n                if (jsonData.foods && Array.isArray(jsonData.foods)) {\n                    jsonData.foods.forEach((food)=>{\n                        foodItems.push({\n                            name: food.name || 'Unknown food',\n                            confidence: food.confidence || 0.9,\n                            portion: food.portion || 'regular'\n                        });\n                    });\n                }\n            } else {\n                // Extract food items by parsing text sections\n                const lines = aiContent.split('\\n');\n                let inFoodSection = false;\n                const foodMatches = [];\n                for(let i = 0; i < lines.length; i++){\n                    const line = lines[i].trim();\n                    const lowerLine = line.toLowerCase();\n                    // Identify food item sections\n                    if (lowerLine.includes('food item') || lowerLine.includes('identified') || lowerLine.match(/^\\d+\\.\\s*identified/) || lowerLine.match(/^food items:/i)) {\n                        inFoodSection = true;\n                        continue;\n                    }\n                    if (inFoodSection && line) {\n                        // Check for section transitions\n                        if (lowerLine.includes('nutrition') || lowerLine.includes('health') || lowerLine.includes('dietary') || lowerLine.match(/^\\d+\\.\\s*(nutrition|health)/)) {\n                            inFoodSection = false;\n                            continue;\n                        }\n                        // Identify food items (usually formatted as lists or with colons)\n                        if (line.match(/^[-•*]\\s/) || line.match(/^\\d+\\.\\s/) || line.includes(':') || line.length > 3 && !line.match(/^[#>]/)) {\n                            foodMatches.push(line);\n                        }\n                    }\n                }\n                // Process the identified food items\n                foodMatches.forEach((match, index)=>{\n                    // Clean up the text and extract the food name\n                    let name = match;\n                    name = name.replace(/^[-•*\\d\\.\\s]+/, '').trim(); // Remove list markers\n                    name = name.split(/[:–—]/)[0].trim(); // Take part before colon or dash\n                    if (name && name.length > 2 && !name.toLowerCase().includes('could not identify')) {\n                        foodItems.push({\n                            name,\n                            confidence: 0.9 - index * 0.05,\n                            portion: 'regular'\n                        });\n                    }\n                });\n            }\n            // If no food items were found, extract potential mentions from the text\n            if (foodItems.length === 0) {\n                // Look for food item mentions using common patterns\n                const foodMentionMatches = aiContent.match(/\\b(apple|banana|orange|pizza|burger|sandwich|salad|pasta|rice|chicken|beef|fish)\\b/ig);\n                if (foodMentionMatches && foodMentionMatches.length > 0) {\n                    // Deduplicate\n                    const uniqueFoods = [\n                        ...new Set(foodMentionMatches.map((item)=>{\n                            return item.charAt(0).toUpperCase() + item.slice(1).toLowerCase();\n                        }))\n                    ];\n                    uniqueFoods.forEach((food, index)=>{\n                        foodItems.push({\n                            name: typeof food === 'string' ? food : String(food),\n                            confidence: 0.8 - index * 0.1,\n                            portion: 'regular'\n                        });\n                    });\n                }\n            }\n        } catch (parseError) {\n            console.error('Error parsing Grok response:', parseError);\n        }\n        // Final fallback if no food items were extracted\n        if (foodItems.length === 0) {\n            foodItems.push({\n                name: \"Unidentified food item\",\n                confidence: 0.5,\n                portion: 'regular'\n            });\n        }\n        // Create and return the formatted response\n        return {\n            description: aiContent.substring(0, 200) + (aiContent.length > 200 ? '...' : ''),\n            foodItems,\n            detailedAnalysis: aiContent\n        };\n    } catch (error) {\n        console.error('Error analyzing image with Grok:', error);\n        // Handle specific API errors for better debugging\n        if (axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isAxiosError(error)) {\n            const axiosError = error;\n            if (axiosError.response) {\n                // The request was made and the server responded with a status code outside of 2xx range\n                console.error('API error response:', axiosError.response.status, axiosError.response.data);\n                throw new Error(`Grok API error (${axiosError.response.status}): ${JSON.stringify(axiosError.response.data)}`);\n            } else if (axiosError.request) {\n                // The request was made but no response was received\n                console.error('API request error - no response received');\n                throw new Error('No response received from Grok API. Please check your network connection and API endpoint.');\n            }\n        }\n        // Generic error fallback\n        throw new Error(`Grok analysis failed: ${error.message || error}`);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU8sSUFBSUMsT0FBTztJQUNuRTtBQUNGIiwic291cmNlcyI6WyJDOlxcUHJvamVjdHNcXEhhY2thdGhvbiBKdWx5IDIwMjVcXFZpdGFsbWF0cml4XFxzcmNcXHNlcnZpY2VzXFxncm9rQ2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcywgeyBBeGlvc0Vycm9yIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IGh0dHBzIGZyb20gJ2h0dHBzJztcblxuLy8gVHlwZXMgZm9yIEdyb2sgQVBJIHJlc3BvbnNlc1xuZXhwb3J0IGludGVyZmFjZSBHcm9rVmlzaW9uUmVzcG9uc2Uge1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBmb29kSXRlbXM6IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xuICAgIHBvcnRpb246IHN0cmluZztcbiAgfVtdO1xuICBkZXRhaWxlZEFuYWx5c2lzOiBzdHJpbmc7XG59XG5cbi8qKlxuICogQW5hbHl6ZSBhbiBpbWFnZSB1c2luZyB0aGUgR3JvayBWaXNpb24gQVBJXG4gKiBAcGFyYW0gaW1hZ2VEYXRhVXJsIC0gQmFzZTY0IGVuY29kZWQgaW1hZ2UgZGF0YSBVUkwgKGRhdGE6aW1hZ2UvanBlZztiYXNlNjQseHh4eHgpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhbmFseXplSW1hZ2VXaXRoR3JvayhpbWFnZURhdGFVcmw6IHN0cmluZyk6IFByb21pc2U8R3Jva1Zpc2lvblJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ1NlbmRpbmcgaW1hZ2UgdG8gR3JvayBWaXNpb24gQVBJIGZvciBhbmFseXNpcycpO1xuICAgIFxuICAgIC8vIFRoaXMgaXMgYSBzZXJ2ZXItc2lkZSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIGZyb20gdGhlIEFQSSByb3V0ZVxuICAgIC8vIE5vdCBmcm9tIHRoZSBjbGllbnQgYnJvd3NlciAtIHRoaXMgYXZvaWRzIENPUlMgYW5kIFNTTCBpc3N1ZXNcbiAgICBcbiAgICAvLyBGb3Igc2VjdXJpdHksIHdlJ2xsIGdldCB0aGUgQVBJIGtleSBmcm9tIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgIGNvbnN0IEdST0tfQVBJX0tFWSA9IHByb2Nlc3MuZW52LkdST0tfQVBJX0tFWTtcbiAgICBpZiAoIUdST0tfQVBJX0tFWSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdHUk9LX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldCcpO1xuICAgIH1cbiAgICBcbiAgICAvLyBVc2UgdGhlIGNvcnJlY3QgQVBJIGVuZHBvaW50IGZyb20gdGhlIHhBSSBkb2N1bWVudGF0aW9uXG4gICAgY29uc3QgR1JPS19BUElfRU5EUE9JTlQgPSBwcm9jZXNzLmVudi5HUk9LX0FQSV9FTkRQT0lOVCB8fCAnaHR0cHM6Ly9hcGkueC5haS92MS9jaGF0L2NvbXBsZXRpb25zJztcbiAgICBcbiAgICAvLyBVc2UgdGhlIGFwcHJvcHJpYXRlIG1vZGVsIHZlcnNpb25cbiAgICBjb25zdCBHUk9LX01PREVMID0gcHJvY2Vzcy5lbnYuR1JPS19NT0RFTCB8fCAnZ3Jvay0yLXZpc2lvbi0xMjEyJzsgLy8gVmlzaW9uLWNhcGFibGUgbW9kZWxcbiAgICBcbiAgICBjb25zb2xlLmxvZygnVXNpbmcgQVBJIGVuZHBvaW50OicsIEdST0tfQVBJX0VORFBPSU5UKTtcbiAgICBjb25zb2xlLmxvZygnVXNpbmcgbW9kZWw6JywgR1JPS19NT0RFTCk7XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgdGhhdCB3ZSBoYXZlIGEgcHJvcGVyIGRhdGEgVVJMXG4gICAgaWYgKCFpbWFnZURhdGFVcmwuc3RhcnRzV2l0aCgnZGF0YTppbWFnZScpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW1hZ2UgZm9ybWF0LiBFeHBlY3RlZCBkYXRhIFVSTCBmb3JtYXQuJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEZvcm1hdCByZXF1ZXN0IGFjY29yZGluZyB0byB0aGUgeEFJIEFQSSBzcGVjaWZpY2F0aW9uXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcyh7XG4gICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgIHVybDogR1JPS19BUElfRU5EUE9JTlQsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke0dST0tfQVBJX0tFWX1gLFxuICAgICAgfSxcbiAgICAgIHRpbWVvdXQ6IDMwMDAwLCAvLyAzMCBzZWNvbmQgdGltZW91dFxuICAgICAgLy8gQ29uZmlndXJlIGF4aW9zIHdpdGggcHJvcGVyIFNTTCBoYW5kbGluZ1xuICAgICAgaHR0cHNBZ2VudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgJiYgcHJvY2Vzcy5lbnYuQUxMT1dfSU5TRUNVUkVfU1NMID09PSAndHJ1ZScgXG4gICAgICAgID8gbmV3IGh0dHBzLkFnZW50KHsgcmVqZWN0VW5hdXRob3JpemVkOiBmYWxzZSB9KSAvLyBPbmx5IGluIGRldmVsb3BtZW50IHdpdGggZXhwbGljaXQgcGVybWlzc2lvblxuICAgICAgICA6IHVuZGVmaW5lZCwgLy8gVXNlIGRlZmF1bHQgc2VjdXJlIHNldHRpbmdzIGluIHByb2R1Y3Rpb25cbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbW9kZWw6IEdST0tfTU9ERUwsIC8vIFVzaW5nIGNvbmZpZ3VyYWJsZSBtb2RlbCBmcm9tIGVudmlyb25tZW50IG9yIGRlZmF1bHRcbiAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgeyBcbiAgICAgICAgICAgICAgICB0eXBlOiBcInRleHRcIiwgXG50ZXh0OiBgQW5hbHl6ZSB0aGlzIGZvb2QgaW1hZ2UgYW5kIHByb3ZpZGUgYSBkZXRhaWxlZCBudXRyaXRpb25hbCBhbmFseXNpcy4gUmV0dXJuIHlvdXIgcmVzcG9uc2UgYXMgYSBKU09OIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxuXG57XG4gIFwiZm9vZHNcIjogW1xuICAgIHtcbiAgICAgIFwibmFtZVwiOiBcIkZvb2QgaXRlbSBuYW1lXCIsXG4gICAgICBcInBvcnRpb25cIjogXCJFc3RpbWF0ZWQgcG9ydGlvbiBzaXplXCIsXG4gICAgICBcImNhbG9yaWVzXCI6IFwiRXN0aW1hdGVkIGNhbG9yaWVzIHBlciBzZXJ2aW5nXCIsXG4gICAgICBcIm1hY3Jvc1wiOiB7XG4gICAgICAgIFwicHJvdGVpblwiOiBcIlggZ3JhbXNcIixcbiAgICAgICAgXCJjYXJic1wiOiBcIlggZ3JhbXNcIixcbiAgICAgICAgXCJmYXRcIjogXCJYIGdyYW1zXCIsXG4gICAgICAgIFwiZmliZXJcIjogXCJYIGdyYW1zXCJcbiAgICAgIH0sXG4gICAgICBcInZpdGFtaW5zXCI6IFtcIktleSB2aXRhbWlucyBwcmVzZW50XCJdLFxuICAgICAgXCJtaW5lcmFsc1wiOiBbXCJLZXkgbWluZXJhbHMgcHJlc2VudFwiXVxuICAgIH1cbiAgXSxcbiAgXCJ0b3RhbE51dHJpdGlvblwiOiB7XG4gICAgXCJjYWxvcmllc1wiOiBcIlRvdGFsIGVzdGltYXRlZCBjYWxvcmllc1wiLFxuICAgIFwicHJvdGVpblwiOiBcIlRvdGFsIHByb3RlaW5cIixcbiAgICBcImNhcmJzXCI6IFwiVG90YWwgY2FyYm9oeWRyYXRlc1wiLFxuICAgIFwiZmF0XCI6IFwiVG90YWwgZmF0XCJcbiAgfSxcbiAgXCJoZWFsdGhTY29yZVwiOiBcIjEtMTAgcmF0aW5nXCIsXG4gIFwiYmVuZWZpdHNcIjogW1wiSGVhbHRoIGJlbmVmaXRzXCJdLFxuICBcImNvbmNlcm5zXCI6IFtcIkhlYWx0aCBjb25jZXJucyBpZiBhbnlcIl0sXG4gIFwiZGlldGFyeVRhZ3NcIjogW1widmVnZXRhcmlhblwiLCBcInZlZ2FuXCIsIFwiZ2x1dGVuLWZyZWVcIiwgXCJkYWlyeS1mcmVlXCIsIFwia2V0by1mcmllbmRseVwiLCBcImhpZ2gtcHJvdGVpblwiLCBcImxvdy1jYXJiXCIsIGV0Yy5dXG59XG5cblByb3ZpZGUgYWNjdXJhdGUgbnV0cml0aW9uYWwgZXN0aW1hdGVzIGJhc2VkIG9uIHZpc2libGUgcG9ydGlvbnMgYW5kIHR5cGljYWwgc2VydmluZyBzaXplcy5gIFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7IFxuICAgICAgICAgICAgICAgIHR5cGU6IFwiaW1hZ2VfdXJsXCIsIFxuICAgICAgICAgICAgICAgIGltYWdlX3VybDogeyBcbiAgICAgICAgICAgICAgICAgIHVybDogaW1hZ2VEYXRhVXJsLCAvLyBVc2UgdGhlIGNvbXBsZXRlIGRhdGEgVVJMIGFzIHByb3ZpZGVkXG4gICAgICAgICAgICAgICAgICBkZXRhaWw6IFwiaGlnaFwiIC8vIFVzZSBoaWdoIGRldGFpbCBmb3IgYmV0dGVyIG51dHJpdGlvbmFsIGFuYWx5c2lzXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4X3Rva2VuczogMTAyNFxuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIGlmICghcmVzcG9uc2UuZGF0YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWNlaXZlZCBlbXB0eSByZXNwb25zZSBmcm9tIEdyb2sgQVBJJyk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ1JlY2VpdmVkIHJlc3BvbnNlIGZyb20gR3JvayBBUEknKTtcbiAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgdXNhZ2U6JywgcmVzcG9uc2UuZGF0YS51c2FnZSk7IC8vIExvZyB0b2tlbiB1c2FnZSBmb3IgbW9uaXRvcmluZ1xuXG4gICAgLy8gUHJvY2VzcyB0aGUgQUkgcmVzcG9uc2UgaW50byBvdXIgZXhwZWN0ZWQgZm9ybWF0XG4gICAgaWYgKCFyZXNwb25zZS5kYXRhLmNob2ljZXMgfHwgIXJlc3BvbnNlLmRhdGEuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCkge1xuICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCByZXNwb25zZSBzdHJ1Y3R1cmU6JywgcmVzcG9uc2UuZGF0YSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gR3JvayBBUEk6IG1pc3NpbmcgY2hvaWNlcyBvciBjb250ZW50Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgYWlDb250ZW50ID0gcmVzcG9uc2UuZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICBjb25zb2xlLmxvZygnQUkgQ29udGVudCByZWNlaXZlZCwgbGVuZ3RoOicsIGFpQ29udGVudC5sZW5ndGgpO1xuXG4gICAgLy8gRXh0cmFjdCBmb29kIGl0ZW1zIGFuZCBvdGhlciBkZXRhaWxzXG4gICAgY29uc3QgZm9vZEl0ZW1zOiBBcnJheTx7bmFtZTogc3RyaW5nOyBjb25maWRlbmNlOiBudW1iZXI7IHBvcnRpb246IHN0cmluZ30+ID0gW107XG4gICAgXG4gICAgLy8gVHJ5IHRvIHBhcnNlIHRoZSByZXNwb25zZSBiYXNlZCBvbiBmb3JtYXR0aW5nXG4gICAgdHJ5IHtcbiAgICAgIC8vIEZpcnN0IGNoZWNrIGlmIHRoZXJlIGFyZSBKU09OIGJsb2NrcyBpbiB0aGUgcmVzcG9uc2VcbiAgICAgIGNvbnN0IGpzb25NYXRjaCA9IGFpQ29udGVudC5tYXRjaCgvYGBganNvbihbXFxzXFxTXSo/KWBgYC8pO1xuICAgICAgXG4gICAgICBpZiAoanNvbk1hdGNoICYmIGpzb25NYXRjaFsxXSkge1xuICAgICAgICAvLyBQYXJzZSBhbnkgSlNPTiBkYXRhIGluIHRoZSByZXNwb25zZVxuICAgICAgICBjb25zdCBqc29uRGF0YSA9IEpTT04ucGFyc2UoanNvbk1hdGNoWzFdLnRyaW0oKSk7XG4gICAgICAgIGlmIChqc29uRGF0YS5mb29kcyAmJiBBcnJheS5pc0FycmF5KGpzb25EYXRhLmZvb2RzKSkge1xuICAgICAgICAgIGpzb25EYXRhLmZvb2RzLmZvckVhY2goKGZvb2Q6IGFueSkgPT4ge1xuICAgICAgICAgICAgZm9vZEl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICBuYW1lOiBmb29kLm5hbWUgfHwgJ1Vua25vd24gZm9vZCcsXG4gICAgICAgICAgICAgIGNvbmZpZGVuY2U6IGZvb2QuY29uZmlkZW5jZSB8fCAwLjksXG4gICAgICAgICAgICAgIHBvcnRpb246IGZvb2QucG9ydGlvbiB8fCAncmVndWxhcicsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRXh0cmFjdCBmb29kIGl0ZW1zIGJ5IHBhcnNpbmcgdGV4dCBzZWN0aW9uc1xuICAgICAgICBjb25zdCBsaW5lcyA9IGFpQ29udGVudC5zcGxpdCgnXFxuJyk7XG4gICAgICAgIGxldCBpbkZvb2RTZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IGZvb2RNYXRjaGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7XG4gICAgICAgICAgY29uc3QgbG93ZXJMaW5lID0gbGluZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIElkZW50aWZ5IGZvb2QgaXRlbSBzZWN0aW9uc1xuICAgICAgICAgIGlmIChsb3dlckxpbmUuaW5jbHVkZXMoJ2Zvb2QgaXRlbScpIHx8IGxvd2VyTGluZS5pbmNsdWRlcygnaWRlbnRpZmllZCcpIHx8IFxuICAgICAgICAgICAgICBsb3dlckxpbmUubWF0Y2goL15cXGQrXFwuXFxzKmlkZW50aWZpZWQvKSB8fCBsb3dlckxpbmUubWF0Y2goL15mb29kIGl0ZW1zOi9pKSkge1xuICAgICAgICAgICAgaW5Gb29kU2VjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGluRm9vZFNlY3Rpb24gJiYgbGluZSkge1xuICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHNlY3Rpb24gdHJhbnNpdGlvbnNcbiAgICAgICAgICAgIGlmIChsb3dlckxpbmUuaW5jbHVkZXMoJ251dHJpdGlvbicpIHx8IGxvd2VyTGluZS5pbmNsdWRlcygnaGVhbHRoJykgfHwgXG4gICAgICAgICAgICAgICAgbG93ZXJMaW5lLmluY2x1ZGVzKCdkaWV0YXJ5JykgfHwgbG93ZXJMaW5lLm1hdGNoKC9eXFxkK1xcLlxccyoobnV0cml0aW9ufGhlYWx0aCkvKSkge1xuICAgICAgICAgICAgICBpbkZvb2RTZWN0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZGVudGlmeSBmb29kIGl0ZW1zICh1c3VhbGx5IGZvcm1hdHRlZCBhcyBsaXN0cyBvciB3aXRoIGNvbG9ucylcbiAgICAgICAgICAgIGlmIChsaW5lLm1hdGNoKC9eWy3igKIqXVxccy8pIHx8IGxpbmUubWF0Y2goL15cXGQrXFwuXFxzLykgfHwgXG4gICAgICAgICAgICAgICAgbGluZS5pbmNsdWRlcygnOicpIHx8IChsaW5lLmxlbmd0aCA+IDMgJiYgIWxpbmUubWF0Y2goL15bIz5dLykpKSB7XG4gICAgICAgICAgICAgIGZvb2RNYXRjaGVzLnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9jZXNzIHRoZSBpZGVudGlmaWVkIGZvb2QgaXRlbXNcbiAgICAgICAgZm9vZE1hdGNoZXMuZm9yRWFjaCgobWF0Y2g6IHN0cmluZywgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgIC8vIENsZWFuIHVwIHRoZSB0ZXh0IGFuZCBleHRyYWN0IHRoZSBmb29kIG5hbWVcbiAgICAgICAgICBsZXQgbmFtZSA9IG1hdGNoO1xuICAgICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL15bLeKAoipcXGRcXC5cXHNdKy8sICcnKS50cmltKCk7IC8vIFJlbW92ZSBsaXN0IG1hcmtlcnNcbiAgICAgICAgICBuYW1lID0gbmFtZS5zcGxpdCgvWzrigJPigJRdLylbMF0udHJpbSgpOyAvLyBUYWtlIHBhcnQgYmVmb3JlIGNvbG9uIG9yIGRhc2hcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAobmFtZSAmJiBuYW1lLmxlbmd0aCA+IDIgJiYgIW5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY291bGQgbm90IGlkZW50aWZ5JykpIHtcbiAgICAgICAgICAgIGZvb2RJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgY29uZmlkZW5jZTogMC45IC0gKGluZGV4ICogMC4wNSksIC8vIERlY3JlYXNlIGNvbmZpZGVuY2UgZm9yIGxhdGVyIGl0ZW1zXG4gICAgICAgICAgICAgIHBvcnRpb246ICdyZWd1bGFyJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIElmIG5vIGZvb2QgaXRlbXMgd2VyZSBmb3VuZCwgZXh0cmFjdCBwb3RlbnRpYWwgbWVudGlvbnMgZnJvbSB0aGUgdGV4dFxuICAgICAgaWYgKGZvb2RJdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gTG9vayBmb3IgZm9vZCBpdGVtIG1lbnRpb25zIHVzaW5nIGNvbW1vbiBwYXR0ZXJuc1xuICAgICAgICBjb25zdCBmb29kTWVudGlvbk1hdGNoZXMgPSBhaUNvbnRlbnQubWF0Y2goL1xcYihhcHBsZXxiYW5hbmF8b3JhbmdlfHBpenphfGJ1cmdlcnxzYW5kd2ljaHxzYWxhZHxwYXN0YXxyaWNlfGNoaWNrZW58YmVlZnxmaXNoKVxcYi9pZyk7XG4gICAgICAgIGlmIChmb29kTWVudGlvbk1hdGNoZXMgJiYgZm9vZE1lbnRpb25NYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBEZWR1cGxpY2F0ZVxuICAgICAgICAgIGNvbnN0IHVuaXF1ZUZvb2RzID0gWy4uLm5ldyBTZXQoZm9vZE1lbnRpb25NYXRjaGVzLm1hcChpdGVtID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgaXRlbS5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIH0pKV07XG4gICAgICAgICAgXG4gICAgICAgICAgdW5pcXVlRm9vZHMuZm9yRWFjaCgoZm9vZCwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgZm9vZEl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICBuYW1lOiB0eXBlb2YgZm9vZCA9PT0gJ3N0cmluZycgPyBmb29kIDogU3RyaW5nKGZvb2QpLFxuICAgICAgICAgICAgICBjb25maWRlbmNlOiAwLjggLSAoaW5kZXggKiAwLjEpLFxuICAgICAgICAgICAgICBwb3J0aW9uOiAncmVndWxhcicsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgR3JvayByZXNwb25zZTonLCBwYXJzZUVycm9yKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRmluYWwgZmFsbGJhY2sgaWYgbm8gZm9vZCBpdGVtcyB3ZXJlIGV4dHJhY3RlZFxuICAgIGlmIChmb29kSXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBmb29kSXRlbXMucHVzaCh7XG4gICAgICAgIG5hbWU6IFwiVW5pZGVudGlmaWVkIGZvb2QgaXRlbVwiLFxuICAgICAgICBjb25maWRlbmNlOiAwLjUsXG4gICAgICAgIHBvcnRpb246ICdyZWd1bGFyJyxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBDcmVhdGUgYW5kIHJldHVybiB0aGUgZm9ybWF0dGVkIHJlc3BvbnNlXG4gICAgcmV0dXJuIHtcbiAgICAgIGRlc2NyaXB0aW9uOiBhaUNvbnRlbnQuc3Vic3RyaW5nKDAsIDIwMCkgKyAoYWlDb250ZW50Lmxlbmd0aCA+IDIwMCA/ICcuLi4nIDogJycpLCAvLyBUcnVuY2F0ZWQgZGVzY3JpcHRpb25cbiAgICAgIGZvb2RJdGVtcyxcbiAgICAgIGRldGFpbGVkQW5hbHlzaXM6IGFpQ29udGVudFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhbmFseXppbmcgaW1hZ2Ugd2l0aCBHcm9rOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBIYW5kbGUgc3BlY2lmaWMgQVBJIGVycm9ycyBmb3IgYmV0dGVyIGRlYnVnZ2luZ1xuICAgIGlmIChheGlvcy5pc0F4aW9zRXJyb3IoZXJyb3IpKSB7XG4gICAgICBjb25zdCBheGlvc0Vycm9yID0gZXJyb3IgYXMgQXhpb3NFcnJvcjtcbiAgICAgIGlmIChheGlvc0Vycm9yLnJlc3BvbnNlKSB7XG4gICAgICAgIC8vIFRoZSByZXF1ZXN0IHdhcyBtYWRlIGFuZCB0aGUgc2VydmVyIHJlc3BvbmRlZCB3aXRoIGEgc3RhdHVzIGNvZGUgb3V0c2lkZSBvZiAyeHggcmFuZ2VcbiAgICAgICAgY29uc29sZS5lcnJvcignQVBJIGVycm9yIHJlc3BvbnNlOicsIGF4aW9zRXJyb3IucmVzcG9uc2Uuc3RhdHVzLCBheGlvc0Vycm9yLnJlc3BvbnNlLmRhdGEpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEdyb2sgQVBJIGVycm9yICgke2F4aW9zRXJyb3IucmVzcG9uc2Uuc3RhdHVzfSk6ICR7SlNPTi5zdHJpbmdpZnkoYXhpb3NFcnJvci5yZXNwb25zZS5kYXRhKX1gKTtcbiAgICAgIH0gZWxzZSBpZiAoYXhpb3NFcnJvci5yZXF1ZXN0KSB7XG4gICAgICAgIC8vIFRoZSByZXF1ZXN0IHdhcyBtYWRlIGJ1dCBubyByZXNwb25zZSB3YXMgcmVjZWl2ZWRcbiAgICAgICAgY29uc29sZS5lcnJvcignQVBJIHJlcXVlc3QgZXJyb3IgLSBubyByZXNwb25zZSByZWNlaXZlZCcpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHJlc3BvbnNlIHJlY2VpdmVkIGZyb20gR3JvayBBUEkuIFBsZWFzZSBjaGVjayB5b3VyIG5ldHdvcmsgY29ubmVjdGlvbiBhbmQgQVBJIGVuZHBvaW50LicpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBHZW5lcmljIGVycm9yIGZhbGxiYWNrXG4gICAgdGhyb3cgbmV3IEVycm9yKGBHcm9rIGFuYWx5c2lzIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlIHx8IGVycm9yfWApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiYXhpb3MiLCJodHRwcyIsImFuYWx5emVJbWFnZVdpdGhHcm9rIiwiaW1hZ2VEYXRhVXJsIiwiY29uc29sZSIsImxvZyIsIkdST0tfQVBJX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJFcnJvciIsIkdST0tfQVBJX0VORFBPSU5UIiwiR1JPS19NT0RFTCIsInN0YXJ0c1dpdGgiLCJyZXNwb25zZSIsIm1ldGhvZCIsInVybCIsImhlYWRlcnMiLCJ0aW1lb3V0IiwiaHR0cHNBZ2VudCIsIkFMTE9XX0lOU0VDVVJFX1NTTCIsIkFnZW50IiwicmVqZWN0VW5hdXRob3JpemVkIiwidW5kZWZpbmVkIiwiZGF0YSIsIm1vZGVsIiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsInR5cGUiLCJ0ZXh0IiwiaW1hZ2VfdXJsIiwiZGV0YWlsIiwidGVtcGVyYXR1cmUiLCJtYXhfdG9rZW5zIiwidXNhZ2UiLCJjaG9pY2VzIiwibWVzc2FnZSIsImVycm9yIiwiYWlDb250ZW50IiwibGVuZ3RoIiwiZm9vZEl0ZW1zIiwianNvbk1hdGNoIiwibWF0Y2giLCJqc29uRGF0YSIsIkpTT04iLCJwYXJzZSIsInRyaW0iLCJmb29kcyIsIkFycmF5IiwiaXNBcnJheSIsImZvckVhY2giLCJmb29kIiwicHVzaCIsIm5hbWUiLCJjb25maWRlbmNlIiwicG9ydGlvbiIsImxpbmVzIiwic3BsaXQiLCJpbkZvb2RTZWN0aW9uIiwiZm9vZE1hdGNoZXMiLCJpIiwibGluZSIsImxvd2VyTGluZSIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJpbmRleCIsInJlcGxhY2UiLCJmb29kTWVudGlvbk1hdGNoZXMiLCJ1bmlxdWVGb29kcyIsIlNldCIsIm1hcCIsIml0ZW0iLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwiU3RyaW5nIiwicGFyc2VFcnJvciIsImRlc2NyaXB0aW9uIiwic3Vic3RyaW5nIiwiZGV0YWlsZWRBbmFseXNpcyIsImlzQXhpb3NFcnJvciIsImF4aW9zRXJyb3IiLCJzdGF0dXMiLCJzdHJpbmdpZnkiLCJyZXF1ZXN0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/services/grokClient.ts\n");

/***/ }),

/***/ "(api-node)/./src/services/modalClient.ts":
/*!*************************************!*\
  !*** ./src/services/modalClient.ts ***!
  \*************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   analyzeImageWithModal: () => (/* binding */ analyzeImageWithModal)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n/**\n * Modal AI Client for NutriLens\n * \n * This service handles communication with Modal's serverless AI infrastructure\n * to perform advanced food image analysis and nutrition data extraction.\n */ \n/**\n * Analyze food image using Modal's advanced vision models\n * @param imageBase64 Base64 encoded image\n * @param grokAnalysis Optional Grok analysis to enhance food recognition\n * @returns Advanced food analysis results\n */ async function analyzeImageWithModal(imageBase64, grokAnalysis) {\n    try {\n        const MODAL_API_KEY = process.env.MODAL_API_KEY;\n        if (!MODAL_API_KEY) {\n            throw new Error('MODAL_API_KEY environment variable is not set');\n        }\n        const MODAL_API_ENDPOINT = process.env.MODAL_API_ENDPOINT || 'https://api.modal.com/v1/nutrilens/analyze';\n        console.log('Sending image to Modal API for nutritional analysis');\n        // Prepare request payload, including Grok analysis if available\n        const requestPayload = {\n            image: imageBase64,\n            detectionMode: 'food',\n            includeNutrition: true\n        };\n        // If we have Grok analysis, include it to improve Modal's results\n        if (grokAnalysis && grokAnalysis.foodItems && grokAnalysis.foodItems.length > 0) {\n            requestPayload.externalAnalysis = {\n                provider: 'grok',\n                detectedItems: grokAnalysis.foodItems.map((item)=>({\n                        name: item.name,\n                        confidence: item.confidence\n                    }))\n            };\n        }\n        // Call the Modal API\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(MODAL_API_ENDPOINT, requestPayload, {\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${MODAL_API_KEY}`\n            }\n        });\n        if (!response.data) {\n            throw new Error('Received empty response from Modal API');\n        }\n        // Process the real Modal response\n        const modalAnalysis = response.data;\n        // If we enhanced with Grok, add that to the response\n        if (grokAnalysis) {\n            modalAnalysis.enhancedBy = 'Grok Vision AI';\n        }\n        console.log('Successfully received Modal nutritional analysis');\n        return modalAnalysis;\n    } catch (error) {\n        console.error('Error in Modal AI analysis:', error);\n        throw error;\n    }\n} // All simulation code has been removed\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9zZXJ2aWNlcy9tb2RhbENsaWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7OztDQUtDLEdBeUJ5QjtBQUUxQjs7Ozs7Q0FLQyxHQUNNLGVBQWVDLHNCQUNwQkMsV0FBbUIsRUFDbkJDLFlBQWtCO0lBRWxCLElBQUk7UUFDRixNQUFNQyxnQkFBZ0JDLFFBQVFDLEdBQUcsQ0FBQ0YsYUFBYTtRQUMvQyxJQUFJLENBQUNBLGVBQWU7WUFDbEIsTUFBTSxJQUFJRyxNQUFNO1FBQ2xCO1FBRUEsTUFBTUMscUJBQXFCSCxRQUFRQyxHQUFHLENBQUNFLGtCQUFrQixJQUFJO1FBRTdEQyxRQUFRQyxHQUFHLENBQUM7UUFFWixnRUFBZ0U7UUFDaEUsTUFBTUMsaUJBQXNCO1lBQzFCQyxPQUFPVjtZQUNQVyxlQUFlO1lBQ2ZDLGtCQUFrQjtRQUNwQjtRQUVBLGtFQUFrRTtRQUNsRSxJQUFJWCxnQkFBZ0JBLGFBQWFZLFNBQVMsSUFBSVosYUFBYVksU0FBUyxDQUFDQyxNQUFNLEdBQUcsR0FBRztZQUMvRUwsZUFBZU0sZ0JBQWdCLEdBQUc7Z0JBQ2hDQyxVQUFVO2dCQUNWQyxlQUFlaEIsYUFBYVksU0FBUyxDQUFDSyxHQUFHLENBQUMsQ0FBQ0MsT0FBZTt3QkFDeERDLE1BQU1ELEtBQUtDLElBQUk7d0JBQ2ZDLFlBQVlGLEtBQUtFLFVBQVU7b0JBQzdCO1lBQ0Y7UUFDRjtRQUVBLHFCQUFxQjtRQUNyQixNQUFNQyxXQUFXLE1BQU14QixrREFBVSxDQUMvQlEsb0JBQ0FHLGdCQUNBO1lBQ0VlLFNBQVM7Z0JBQ1AsZ0JBQWdCO2dCQUNoQixpQkFBaUIsQ0FBQyxPQUFPLEVBQUV0QixlQUFlO1lBQzVDO1FBQ0Y7UUFHRixJQUFJLENBQUNvQixTQUFTRyxJQUFJLEVBQUU7WUFDbEIsTUFBTSxJQUFJcEIsTUFBTTtRQUNsQjtRQUVBLGtDQUFrQztRQUNsQyxNQUFNcUIsZ0JBQWdCSixTQUFTRyxJQUFJO1FBRW5DLHFEQUFxRDtRQUNyRCxJQUFJeEIsY0FBYztZQUNoQnlCLGNBQWNDLFVBQVUsR0FBRztRQUM3QjtRQUVBcEIsUUFBUUMsR0FBRyxDQUFDO1FBQ1osT0FBT2tCO0lBQ1QsRUFBRSxPQUFPRSxPQUFPO1FBQ2RyQixRQUFRcUIsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsTUFBTUE7SUFDUjtBQUNGLEVBRUEsdUNBQXVDIiwic291cmNlcyI6WyJDOlxcUHJvamVjdHNcXEhhY2thdGhvbiBKdWx5IDIwMjVcXFZpdGFsbWF0cml4XFxzcmNcXHNlcnZpY2VzXFxtb2RhbENsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1vZGFsIEFJIENsaWVudCBmb3IgTnV0cmlMZW5zXG4gKiBcbiAqIFRoaXMgc2VydmljZSBoYW5kbGVzIGNvbW11bmljYXRpb24gd2l0aCBNb2RhbCdzIHNlcnZlcmxlc3MgQUkgaW5mcmFzdHJ1Y3R1cmVcbiAqIHRvIHBlcmZvcm0gYWR2YW5jZWQgZm9vZCBpbWFnZSBhbmFseXNpcyBhbmQgbnV0cml0aW9uIGRhdGEgZXh0cmFjdGlvbi5cbiAqL1xuXG5pbnRlcmZhY2UgTW9kYWxBbmFseXNpc1Jlc3BvbnNlIHtcbiAgZm9vZEl0ZW1zOiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcbiAgICBwb3J0aW9uPzogc3RyaW5nO1xuICB9W107XG4gIG51dHJpdGlvbmFsRXN0aW1hdGU6IHtcbiAgICBjYWxvcmllczogbnVtYmVyO1xuICAgIHByb3RlaW46IHN0cmluZztcbiAgICBmYXQ6IHN0cmluZztcbiAgICBjYXJiczogc3RyaW5nO1xuICAgIG51dHJpZW50czoge1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgYW1vdW50OiBudW1iZXI7XG4gICAgICB1bml0OiBzdHJpbmc7XG4gICAgICBwZXJjZW50T2ZEYWlseU5lZWRzPzogbnVtYmVyO1xuICAgIH1bXTtcbiAgfTtcbiAgaGVhbHRoSW5zaWdodHM6IHN0cmluZ1tdO1xuICB3YXJuaW5nczogc3RyaW5nW107XG4gIGVuaGFuY2VkQnk/OiBzdHJpbmc7IC8vIEluZGljYXRlcyBpZiBhbmFseXNpcyB3YXMgZW5oYW5jZWQgYnkgYW5vdGhlciBBSSBzeXN0ZW1cbn1cblxuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcblxuLyoqXG4gKiBBbmFseXplIGZvb2QgaW1hZ2UgdXNpbmcgTW9kYWwncyBhZHZhbmNlZCB2aXNpb24gbW9kZWxzXG4gKiBAcGFyYW0gaW1hZ2VCYXNlNjQgQmFzZTY0IGVuY29kZWQgaW1hZ2VcbiAqIEBwYXJhbSBncm9rQW5hbHlzaXMgT3B0aW9uYWwgR3JvayBhbmFseXNpcyB0byBlbmhhbmNlIGZvb2QgcmVjb2duaXRpb25cbiAqIEByZXR1cm5zIEFkdmFuY2VkIGZvb2QgYW5hbHlzaXMgcmVzdWx0c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYW5hbHl6ZUltYWdlV2l0aE1vZGFsKFxuICBpbWFnZUJhc2U2NDogc3RyaW5nLFxuICBncm9rQW5hbHlzaXM/OiBhbnlcbik6IFByb21pc2U8TW9kYWxBbmFseXNpc1Jlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgTU9EQUxfQVBJX0tFWSA9IHByb2Nlc3MuZW52Lk1PREFMX0FQSV9LRVk7XG4gICAgaWYgKCFNT0RBTF9BUElfS0VZKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01PREFMX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldCcpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBNT0RBTF9BUElfRU5EUE9JTlQgPSBwcm9jZXNzLmVudi5NT0RBTF9BUElfRU5EUE9JTlQgfHwgJ2h0dHBzOi8vYXBpLm1vZGFsLmNvbS92MS9udXRyaWxlbnMvYW5hbHl6ZSc7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ1NlbmRpbmcgaW1hZ2UgdG8gTW9kYWwgQVBJIGZvciBudXRyaXRpb25hbCBhbmFseXNpcycpO1xuICAgIFxuICAgIC8vIFByZXBhcmUgcmVxdWVzdCBwYXlsb2FkLCBpbmNsdWRpbmcgR3JvayBhbmFseXNpcyBpZiBhdmFpbGFibGVcbiAgICBjb25zdCByZXF1ZXN0UGF5bG9hZDogYW55ID0ge1xuICAgICAgaW1hZ2U6IGltYWdlQmFzZTY0LFxuICAgICAgZGV0ZWN0aW9uTW9kZTogJ2Zvb2QnLFxuICAgICAgaW5jbHVkZU51dHJpdGlvbjogdHJ1ZVxuICAgIH07XG4gICAgXG4gICAgLy8gSWYgd2UgaGF2ZSBHcm9rIGFuYWx5c2lzLCBpbmNsdWRlIGl0IHRvIGltcHJvdmUgTW9kYWwncyByZXN1bHRzXG4gICAgaWYgKGdyb2tBbmFseXNpcyAmJiBncm9rQW5hbHlzaXMuZm9vZEl0ZW1zICYmIGdyb2tBbmFseXNpcy5mb29kSXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgcmVxdWVzdFBheWxvYWQuZXh0ZXJuYWxBbmFseXNpcyA9IHtcbiAgICAgICAgcHJvdmlkZXI6ICdncm9rJyxcbiAgICAgICAgZGV0ZWN0ZWRJdGVtczogZ3Jva0FuYWx5c2lzLmZvb2RJdGVtcy5tYXAoKGl0ZW06IGFueSkgPT4gKHtcbiAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXG4gICAgICAgICAgY29uZmlkZW5jZTogaXRlbS5jb25maWRlbmNlXG4gICAgICAgIH0pKVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2FsbCB0aGUgTW9kYWwgQVBJXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KFxuICAgICAgTU9EQUxfQVBJX0VORFBPSU5ULFxuICAgICAgcmVxdWVzdFBheWxvYWQsXG4gICAgICB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke01PREFMX0FQSV9LRVl9YCxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApO1xuICAgIFxuICAgIGlmICghcmVzcG9uc2UuZGF0YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWNlaXZlZCBlbXB0eSByZXNwb25zZSBmcm9tIE1vZGFsIEFQSScpO1xuICAgIH1cbiAgICBcbiAgICAvLyBQcm9jZXNzIHRoZSByZWFsIE1vZGFsIHJlc3BvbnNlXG4gICAgY29uc3QgbW9kYWxBbmFseXNpcyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgXG4gICAgLy8gSWYgd2UgZW5oYW5jZWQgd2l0aCBHcm9rLCBhZGQgdGhhdCB0byB0aGUgcmVzcG9uc2VcbiAgICBpZiAoZ3Jva0FuYWx5c2lzKSB7XG4gICAgICBtb2RhbEFuYWx5c2lzLmVuaGFuY2VkQnkgPSAnR3JvayBWaXNpb24gQUknO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygnU3VjY2Vzc2Z1bGx5IHJlY2VpdmVkIE1vZGFsIG51dHJpdGlvbmFsIGFuYWx5c2lzJyk7XG4gICAgcmV0dXJuIG1vZGFsQW5hbHlzaXM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gTW9kYWwgQUkgYW5hbHlzaXM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8vIEFsbCBzaW11bGF0aW9uIGNvZGUgaGFzIGJlZW4gcmVtb3ZlZFxuIl0sIm5hbWVzIjpbImF4aW9zIiwiYW5hbHl6ZUltYWdlV2l0aE1vZGFsIiwiaW1hZ2VCYXNlNjQiLCJncm9rQW5hbHlzaXMiLCJNT0RBTF9BUElfS0VZIiwicHJvY2VzcyIsImVudiIsIkVycm9yIiwiTU9EQUxfQVBJX0VORFBPSU5UIiwiY29uc29sZSIsImxvZyIsInJlcXVlc3RQYXlsb2FkIiwiaW1hZ2UiLCJkZXRlY3Rpb25Nb2RlIiwiaW5jbHVkZU51dHJpdGlvbiIsImZvb2RJdGVtcyIsImxlbmd0aCIsImV4dGVybmFsQW5hbHlzaXMiLCJwcm92aWRlciIsImRldGVjdGVkSXRlbXMiLCJtYXAiLCJpdGVtIiwibmFtZSIsImNvbmZpZGVuY2UiLCJyZXNwb25zZSIsInBvc3QiLCJoZWFkZXJzIiwiZGF0YSIsIm1vZGFsQW5hbHlzaXMiLCJlbmhhbmNlZEJ5IiwiZXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./src/services/modalClient.ts\n");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0"], () => (__webpack_exec__("(api-node)/./node_modules/.pnpm/next@15.4.1_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai-analyze-food&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Cai-analyze-food.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();